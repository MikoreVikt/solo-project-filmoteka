{"mappings":"AAAA,MAAMA,EAAaC,SAASC,cAAc,YAI1C,IAAIC,EAAW,oCAKfC,eAA6BC,GAC3B,IACE,MAAMC,QAuBDC,MAAM,0FAAmDC,MAC9DC,IACE,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAMF,EAASG,QAE3B,OAAOH,EAASI,MAAM,IA5BYL,MAAKM,GAAQA,EAAKC,SAChDC,QAWMC,EAXkBZ,EAYzBE,MACL,iGAA0DU,KAC1DT,MAAKC,IACL,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAMF,EAASG,QAE3B,OAAOH,EAASI,MAAM,KAlBcL,MAAKM,GAAQA,EAAKI,UAgE7BH,EA/DFT,EAAVU,EAgETG,SAAQC,IACZ,MAAMC,EAAQD,EAAKE,UAAUC,KAAIC,IAC/B,MAAMC,EAAWV,EAAOW,MAAKC,GAASA,EAAMH,KAAOA,IAEnD,OAAOC,EAAWA,EAASG,KAAO,SAAS,IAG7CR,EAAKS,WACHR,EAAMS,OAAS,EAAIT,EAAMU,KAAK,MAAQ,GAAGV,EAAM,OAAOA,EAAM,WAAW,IAY7E,SAAwBW,GACtBA,EAAMb,SAAQC,IACPA,EAAKa,cACR9B,EAAW,qBAERiB,EAAKc,eACRd,EAAKc,aAAe,KAElBd,EAAKe,aAAe,GAAKf,EAAKe,aAAe,MAC/Cf,EAAKe,aAAe,EAAC,G,CA5FvBC,CAAepB,GA8BnB,SAAsBF,GACpB,MAAMuB,EAASvB,EACZS,KACC,EAACC,GAAEA,EAAES,YAAEA,EAAWK,MAAEA,EAAKT,WAAEA,EAAUK,aAAEA,EAAYC,aAAEA,MACnD,MAAMI,EAAOL,EAAaM,MAAM,EAAG,GACpBL,EAAaM,QAAQ,GAEpC,MAAO,2CACyBjB,qMAKTA,+BAPXrB,EAAW8B,+BASJK,4LAKwBA,sDACNT,OAAgBU,uFAIhD,IAGRR,KAAK,IACR/B,EAAW0C,UAAYL,C,CA1DrBM,CAAa3B,E,CACb,MAAO4B,GA0ET5C,EAAW0C,UAAY,qH,CAdzB,IAA6B3B,EArDbE,C,CAFhB4B,CAdW,GCJX,IACIC,EACJ,MAAMC,EAAQC,GAAY/C,SAASC,cAAc8C,GAoCjD,SAASC,IACPhD,SAASiD,oBAAoB,UAAWC,GACxCJ,EAAM,aAAaK,UAAUC,IAAI,aACjCN,EAAM,QAAQK,UAAUE,OAAO,Y,CASjC,SAASH,EAAcI,GACN,WAAXA,EAAEC,MACJP,G,CAhDJF,EAAM,YAAYU,iBAAiB,SAanC,SAAuBF,GAErB,GADAA,EAAEG,kBAECH,EAAEI,OAAOC,QAAQ,MAAMR,UAAUS,SAAS,SAC3CN,EAAEI,OAAOP,UAAUS,SAAS,WAE5B,QAfarC,EAiBC+B,EAAEI,OAAOC,QAAQ,MAAME,QAAQtC,GAhBxCjB,MAAM,sCAAqBiB,8CAAyBhB,MAAKC,IAC9D,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAMF,EAASG,QAE3B,OAAOH,EAASI,MAAM,KAaPL,MAAKM,KA8BxB,UAA2BU,GACzBA,EAAES,YACFA,EAAW8B,eACXA,EAAcC,WACdA,EAAU7B,aACVA,EAAY8B,WACZA,EAAUlD,OACVA,EAAMmD,SACNA,IAEA,MAAMvC,EAAQZ,EAAOQ,KAAI4C,GAAOA,EAAIvC,OAAMG,KAAK,MACzCqC,EAAUC,KAAKC,MAAMN,GAEzBlB,EAtEgB,wCAqEdb,EApEU,mCAqEMA,EAtEF,sCA0ElB,MAAMI,EAAS,yIAGkCS,WAAaiB,wIAGRvC,MAAOuC,uRAIuC5B,uCAAkD8B,4OAI7EG,yOAIAL,gOAIApC,4PAKjBuC,2VASxDnB,EAAM,kBAAkBL,UAAYL,C,CAlFlCkC,CAAkBzD,EAAK,IAMzBb,SAASwD,iBAAiB,UAAWN,GACrCJ,EAAM,aAAaK,UAAUE,OAAO,aACpCP,EAAM,QAAQK,UAAUC,IAAI,aA3B9B,IAAiB7B,C,IAHjBuB,EAAM,qBAAqBU,iBAAiB,QAASR,GACrDF,EAAM,aAAaU,iBAAiB,SAsCpC,SAAyBF,GACnBA,EAAEI,OAAOP,UAAUS,SAAS,aAC9BZ,G","sources":["src/js/main/main.js","src/js/movie-card/movie-card.js"],"sourcesContent":["const galleryRef = document.querySelector('.gallery');\n\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst API_KEY = '14ce8915ef52d801924d89668f2ca827';\nlet imgHttps = 'https://image.tmdb.org/t/p/w500/';\nlet src;\n\nlet page = 1;\n\nasync function createGallery(page) {\n  try {\n    const genresArr = await getGenres().then(data => data.genres);\n    const filmsArr = await getApi(page).then(data => data.results);\n    createGenres(filmsArr, genresArr);\n    validationData(filmsArr);\n    createMarkup(filmsArr);\n  } catch (error) {\n    createError();\n  }\n}\n\ncreateGallery(page);\n\nfunction getApi(page) {\n  return fetch(\n    `${BASE_URL}/trending/movie/day?api_key=${API_KEY}&page=${page}`\n  ).then(response => {\n    if (!response.ok) {\n      throw new Error(response.status);\n    }\n    return response.json();\n  });\n}\nfunction getGenres() {\n  return fetch(`${BASE_URL}/genre/movie/list?api_key=${API_KEY}`).then(\n    response => {\n      if (!response.ok) {\n        throw new Error(response.status);\n      }\n      return response.json();\n    }\n  );\n}\n\nfunction createMarkup(data) {\n  const markup = data\n    .map(\n      ({ id, poster_path, title, genre_name, release_date, vote_average }) => {\n        const date = release_date.slice(0, 4);\n        const rating = vote_average.toFixed(1);\n        const src = imgHttps + poster_path;\n        return `\n            <li class=\"item\" data-id=\"${id}\">\n                <a class=\"item__link\" href=\"\">\n                <div class=\"item__img-frame\">\n                    <img\n                    class=\"item__img\"\n                    data-id=\"${id}\"\n                    src=${src}\n                    alt=\"${title}\"\n                    loading=\"lazy\"\n                    />\n                </div>\n                <div class=\"item__text-frame\">\n                    <h3 class=\"item__text title\">${title}</h3>\n                    <h3 class=\"item__text\">${genre_name} | ${date}</h3>\n                </div>\n                </a>\n            </li>\n            `;\n      }\n    )\n    .join(``);\n  galleryRef.innerHTML = markup;\n}\n\nfunction createGenres(films, genres) {\n  films.forEach(film => {\n    const names = film.genre_ids.map(id => {\n      const genreObj = genres.find(genre => genre.id === id);\n\n      return genreObj ? genreObj.name : 'Unknown';\n    });\n\n    film.genre_name =\n      names.length < 3 ? names.join(', ') : `${names[0]}, ${names[1]}, other`;\n  });\n}\n\nfunction createError() {\n  galleryRef.innerHTML = `\n  <section>\n      <p>Error</p>\n      <p>Oops, something went wrong. Please try again later.</p>\n    </section>`;\n}\n\nfunction validationData(films) {\n  films.forEach(film => {\n    if (!film.poster_path) {\n      imgHttps = './default-img.jpg';\n    }\n    if (!film.release_date) {\n      film.release_date = '';\n    }\n    if (film.vote_average < 0 || film.vote_average > 10) {\n      film.vote_average = 0;\n    }\n  });\n}\n","const BASE_URL = 'https://api.themoviedb.org/3';\nconst API_KEY = '14ce8915ef52d801924d89668f2ca827';\nconst DEFAULT_IMG = 'https://i.ibb.co/3NkZfz9/moive1.jpg';\nlet IMG_HTTPS = 'https://image.tmdb.org/t/p/w500/';\nlet src;\nconst getEl = selector => document.querySelector(selector);\n\ngetEl(`.gallery`).addEventListener(`click`, onPosterClick);\ngetEl('.modal__btn-close').addEventListener('click', closeModal);\ngetEl('.backdrop').addEventListener('click', onBackdropClick);\n\nfunction fetchId(id) {\n  return fetch(`${BASE_URL}/movie/${id}?api_key=${API_KEY}`).then(response => {\n    if (!response.ok) {\n      throw new Error(response.status);\n    }\n    return response.json();\n  });\n}\n\nfunction onPosterClick(e) {\n  e.preventDefault();\n  if (\n    !e.target.closest(`li`).classList.contains(`item`) ||\n    e.target.classList.contains(`gallery`)\n  ) {\n    return;\n  }\n  const idValue = e.target.closest(`li`).dataset.id;\n  fetchId(idValue).then(data => {\n    createModalMarkup(data);\n  });\n  openModal();\n}\n\nfunction openModal() {\n  document.addEventListener('keydown', onEscKeyPress);\n  getEl(`.backdrop`).classList.remove(`is-hidden`);\n  getEl(`body`).classList.add(`no-scroll`);\n}\n\nfunction closeModal() {\n  document.removeEventListener('keydown', onEscKeyPress);\n  getEl(`.backdrop`).classList.add(`is-hidden`);\n  getEl(`body`).classList.remove(`no-scroll`);\n}\n\nfunction onBackdropClick(e) {\n  if (e.target.classList.contains('backdrop')) {\n    closeModal();\n  }\n}\n\nfunction onEscKeyPress(e) {\n  if (e.code === 'Escape') {\n    closeModal();\n  }\n}\n\nfunction createModalMarkup({\n  id,\n  poster_path,\n  original_title,\n  popularity,\n  vote_average,\n  vote_count,\n  genres,\n  overview,\n}) {\n  const genre = genres.map(obj => obj.name).join(', ');\n  const popular = Math.round(popularity);\n  if (poster_path !== DEFAULT_IMG) {\n    src = IMG_HTTPS + poster_path;\n  } else {\n    src = DEFAULT_IMG;\n  }\n  const markup = `\n    <div class=\"modal__container\">\n                <div class=\"modal__img-wrap\">\n                    <img class=\"modal__img\" src=\"${src}\" alt=\"${original_title}\">\n                </div>\n                <div class=\"modal__about-movie\">\n                    <h3 class=\"modal__title\" data-id=\"${id}\">${original_title}</h3>\n                    <div class=\"modal__text-wrap\">\n                        <ul>\n                            <li class=\"modal__text-characteristic\">Vote / Votes</li>\n                            <li class=\"modal__text-characteristic-value\"><span class=\"vote average\">${vote_average}</span> / <span class=\"vote count\">${vote_count}</span></li>\n                        </ul>\n                        <ul>\n                            <li class=\"modal__text-characteristic\">Popularity</li>\n                            <li class=\"modal__text-characteristic-value\">${popular}</li>\n                        </ul>\n                        <ul>\n                            <li class=\"modal__text-characteristic\">Original Title</li>\n                            <li class=\"modal__text-characteristic-value\">${original_title}</li>\n                        </ul>\n                        <ul>\n                            <li class=\"modal__text-characteristic\">Genre</li>\n                            <li class=\"modal__text-characteristic-value\">${genre}</li>\n                        </ul>\n                    </div>\n                    <div class=\"modal__overview-wrap\">\n                        <h3 class=\"modal__overview-title\">About</h3>\n                        <p class=\"modal__overview-text\">${overview}</p>\n                    </div>\n                    <div class=\"modal__btn-wrap\">\n                        <button class=\"modal__btn w\" type=\"button\">add to Watched</button>\n                        <button class=\"modal__btn q\" type=\"button\">add to queue</button>\n                    </div>\n                </div>\n            </div>\n    `;\n  getEl('.modal__window').innerHTML = markup;\n}\n"],"names":["$4491d8b02a49620b$var$galleryRef","document","querySelector","$4491d8b02a49620b$var$imgHttps","async","page1","genresArr","fetch","then","response","ok","Error","status","json","data","genres","filmsArr","page2","results","forEach","film","names","genre_ids","map","id","genreObj","find","genre","name","genre_name","length","join","films","poster_path","release_date","vote_average","$4491d8b02a49620b$var$validationData","markup","title","date","slice","toFixed","innerHTML","$4491d8b02a49620b$var$createMarkup","error","$4491d8b02a49620b$var$createGallery","$7c126d120175999e$var$src","$7c126d120175999e$var$getEl","selector","$7c126d120175999e$var$closeModal","removeEventListener","$7c126d120175999e$var$onEscKeyPress","classList","add","remove","e","code","addEventListener","preventDefault","target","closest","contains","dataset","original_title","popularity","vote_count","overview","obj","popular","Math","round","$7c126d120175999e$var$createModalMarkup"],"version":3,"file":"library.d4106122.js.map"}